---
title: "Asymmetric tail-dependence in extreme climatic events affects population-extinction risk"
author: "Shyamolina Ghosh, Daniel Reuman"
date: "`r format(Sys.time(), '%d %B, %Y')`"
geometry: "left=1in,right=1in,top=1in,bottom=1in"
output: 
  pdf_document:
    number_sections: no
    keep_tex: yes
    fig_caption: yes
    includes:
      in_header: head_maintext.sty
      
tables: True
link-citations: True
urlcolor : blue
indent : True

csl: TheAmericanNaturalist.csl
bibliography: Ref_extrisk.bib
---


```{r setup_MainText, echo=F}
library(rmarkdown)
knitr::opts_chunk$set(echo = TRUE, fig.pos = "H")
options(scipen = 1, digits = 5) #This option round all numbers appeared in the inline r code upto 5th digit
seed<-101
```

\noindent \emph{Affiliations:}

\noindent Ghosh: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66045, USA

\noindent Reuman: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66047, USA; Laboratory of Populations, Rockefeller University, 1230 York Ave, New York, NY, 10065, USA

\newpage

\noindent \textbf{ABSTRACT} 
<!--200 words limit : J Am Nat-->

With global climate change, extreme climatic events (ECEs) appear to be more common than usual. These ECEs 
could pose severe impact on the resistance or resilience of a population or community level through
life-history traits of the species. Therefore predicting the impact of ECEs 
on extinction risk of a population is necessery. We here introduced the potential use of "tail-dependence" 
property of a copula in modelling the extinction risk of an age-structured single patch model. We also 
extended the generalized findings of density-independent metapopulation model from @Ghosh_copula 
to density-dependence metapopulation models with this copula approach. For metapopulation models, 
we showed extinction risk not only depended on the nature of tail-dependence of spatially correlated 
noise but was also influenced by the inherent dynamics of the population-model.

\textbf{\textit{Keywords:}} extinction risk, extreme events, tail dependence, copula, density-dependent model

\newpage

# Introduction\label{Introduction}

<!--how common are the extreme events?-->
For past few decades, there have been increasing evidences that anthropogenic climate change 
is causing extreme events, e.g. temperature or precipitation extremes,
heat-waves, wild-fire etc. [@ummenhofer2017extreme]. Frequent extreme events 
can shift temperature or precipitation-mean, 
change variability of the distribution, as well as change its 
symmetry or skewness [@hansen2012perception]. Such extreme climatic events (ECE) can pose severe
impacts at the individual, population, community and ecosystem level [@bragazza2008climatic; 
@gutschick2003extreme; @jiguet2011community; @mckechnie2009climate;
@hoover2014resistance]. Therefore, 
understanding the long-term impacts of changes 
in ECEs has been a longstanding interest in ecological research 
[@katz2005statistics; @smith2011ecological; @diez2012will; @moritz2013future; @bailey2016tackling]. 

<!--How extinction risk is related to extreme events : past studies
consequences of extreme events on population life history, community-->
Earlier studies showed ECEs may affect species abundances (species re-ordering) through 
life-history traits and this alteration in community structures could cascade 
through higher hierarchical levels and lead to local extinction of 
species [@thomas2004extinction; @edgar2010nino; @moreno2011extreme]. 
<!--Should I mention idea of match-mismatch hypothesis?-->
For example, 
a study based on annal survival data showed changes
in prey communities induced by extreme flooding affected predators in 
aquatic and adjacent riparian habitats [@chiu2013impact] via trophic linkages. Similarly, 
$43$ years of ring-recovery data was used to examine the demographic impact of ECEs 
through temporal variability in juvenile, immature and adult survival
of European shags on the Isle of May in eastern Scotland [@frederiksen2008demographic].
A recent study [@mcdermott2017sensitivity] investigated the sensitivity 
of $41$ UK butterfly species to four different ECEs (extreme heat, extreme cold, 
extreme precipitation, drought) over $37$ years (1976-2012) at the site level, across 
each species' life-stages. Experimental study showed successive ECEs with short time intervals 
could weaken the resistance of plant communities too [@dreesen2014successive]. 
All these studies indicated that environmental stochasticity (through ECEs) 
can lead to demographic stochasticity (through influence on reproductive or 
mortality rate) of different age class of a population making it vulnerable 
to local extinction. 

<!--How copula could be relevent in estimating extreme event's 
influence on extinction risk : introduce Taildep. concept-->
A recent study [@Ghosh_copula] showed the importance, causes 
and consequences of copula structures in associations between ecologically
important variables and demonstrated a basic example where 
copula was used to model extinction risk of a density-independent 
metapopulation. Present manuscript is an extension for the application of copula 
in estimating the extinction risk as introduced by [@Ghosh_copula]. We will show 
why the potential use of copula
in modelling extinction risk goes beyond the density-independent model 
and even applicable for a simple age-structured population where its vital rates are influenced by ECEs. 
Following we will introduce the concept of copula in a manner that follows @Ghosh_copula.

<!--brief intro for copula-->
Copula, a rank based measure of association, is much more informative 
than linear correlation measure and a widely applied tool in dependence 
modeling [@joe2014_dependence; @nelsen2006_copula]. Copulas separate the information content of a bivariate dataset,
$(x_n, y_n)$ for $n = 1 \ldots N$, into two non-overlapping parts: the information in the marginal 
distributions (which is not about the association between the variables) and the rest of 
the information (which is solely about the association). The association information is revealed by 
the copula plot ($v_n$ against $u_n$) of the raw variables ($y_n$ vs. $x_n$) in Fig...., where 
$u_n$ is the rank of $x_n$ in the set ${x_1, x_2, \ldots , x_n }$, divided by $N + 1$; 
and $v_n$ is the rank of $y_n$ in the set ${y_1, y_2, \ldots , y_n }$, also divided
by $N + 1$. Here the rank of the smallest element of each sets is considered to be 1 and the rank of
the largest element is $N$. We refer to the $u_n$ and $v_n$ as normalized ranks of the $x_n$ and $y_n$. 
Ranking makes the marginal distributions uniform, isolating only the information on 
association between the variables. 

<!--tail dep. of copula & extinction risk-->
A major benefit of the copula approach is that it can effectively capture the tail dependence. 
Tail dependence, already exemplified in Fig..... (add Fig.), is association between the more extreme 
values of distributions. For two positively associated variables, left-tail 
(respectively, right-tail) dependence is stronger association between
values in the left or lower portions, i. e. for smaller values 
(respectively, the right or upper portions, i.e. for higher values) 
of the two distributions. Stronger dependence in either tail gives rise to asymmetric copula 
structure for the joint distribution of two variables. 
For example, extreme cold winter during growing season
might reduce the adult reproduction rate as well as larval survival (i.e. stronger 
tail dependence between vital rates when temperature is too cold than normal), which 
could lead to population crash and thereby inflate the extinction risk. Similarly, in context of 
density-dependent metapopulation models, if extreme environmental fluctuations across sites 
appear to be as synchronous (left tail dependent or right tail dependent between patches 
with same correlation as in Fig.....) then it could wipe out some metapopulation patches 
during unfavorable years unless they are rescued by the nearby populations. This scenario 
could be more complex depending 
on the dynamics of the model (see \nameref{Results}). Though tail-dependence 
property of a copula has been used for risk-analysis in other fields like finance, 
hydrology etc. [@alexander2008market; @li2013; @chen2011flood; @Goswami2018], but to our knowledge
copula have never been used in estimating the effect of ECEs through extinction risk of age structured 
model or density-dependent metapopulations.

<!--our objective ?-->
In this paper, we will explore the potential use of asymmetric tail-dependence in a copula 
for understanding the extinction risk of populations towards extreme climatic event
by addressing the following questions: (Q1) Does nature of tail dependence 
(left tail or right tail) in vital rates
of a single-patch age-structured population model affect extinction risk of that population differently?
We hypothesized population might have higher extinction risk if vital rates are left-tail dependent.
(Q2) How does asymmetric noise copula (tail dependence across multiple patches) influence extinction 
risk of a density-dependent metapopulation model? Our speculation is that the general finding 
from density-independent metapopulation model [@Ghosh_copula]
(higher extinction risk if noises across patches were 
left-tail dependent than the one if noises had right-tail dependence) would hold true only in
the under-compensatory regime, but should be reverse if the model shows over-compensatory dynamics. 
(Q3) We further hypothesize that when there is no dispersal, the above-said switching should occur
near the critical parameter value where the deterministic model shows transition from 
under-compensatory to over-compensatory dynamics.

# Methods\label{Methods}

<!--stochastic matrix model : age structured-->
To investigate (Q1) from \nameref{Introduction} that how copula structure in noisy 
environment affect the extinction risk of
populations in a single patch age-structured model,
we considered a basic stochastic age-structured model (Eq. \ref{eq_age_str}) 
with two age classes (egg $E$ and female adult $A$). We assumed
the population was semelperous, i.e., adult ($A$) went through the
reproductive episode only once before death. Eggs and adults in the 
next generation depend upon the fecundity of adult ($f_a \geq 0$) 
and survival of eggs ($0 \leq s_e \leq 1$) from present generation, respectively.
The environmental stochasticity in the model was embedded in 
the fluctuating vital rates ($f_a$ and $s_e$). We considered the fecundity ($f_a$)
and survival ($s_e$) rates were random draw from a gamma ($\Gamma(k,\theta)$) and
a beta ($\mathcal{B}(\alpha,\beta)$) distribution, respectively. These distributions 
were generated from iid noises showing specific tail-dependence (either in left- or in right-tail)
between fecundity and survival rates. Tail dependence emerged if extreme bad years ("catastrophs") 
would suppress both vital rates (hence, $f_a$ and $s_e$ would show a left tail dependent copula), whereas 
extreme good years ("bonanzas") would increase both of them (i.e., $f_a$ and $s_e$ would show 
a right tail dependent copula). Eq. \ref{eq_vitalrates} represent the stochasticity 
in the vital rates. We included the density dependence effect in one of the vital rate,
namely, fecundity ($f_a$). If $\Omega = \infty$ in Eq. \ref{eq_vitalrates}, 
the projection matrix would be independent
of populations from any age-class and the model was then called to be "linear", whereas
its "nonlinear" version had finite $\Omega$. 

\begin{equation}
\left({\begin{array}{cc} E \\ A \end{array}}\right)_{t+1} = 
\left(\begin{array}{cc} 0 & f_a\\ s_e & 0 \end{array}\right)
\left(\begin{array}{c} E \\ A \end{array}\right)_{t} \label{eq_age_str}
\end{equation}

\begin{equation}
f_a = \Gamma (k, \theta)\exp(-A/\Omega), \hspace{0.2 cm} s_e = \mathcal{B}(\alpha,\beta) \label{eq_vitalrates}
\end{equation}

<!--calculation of ext risk with age-structured model-->
To calculate extinction risk after each time step, we simulated model (\ref{eq_age_str}) for $25$ years
with $10000$ simulations. For each simulation, we started with initial population $(E,A)_{t=0} = (5,10)$
and following Eq. \ref{eq_age_str} we checked whether after each time step the total population $(E+A)_{t}$
was below a certain extinction threshold (we set it as $2$) or not. If it was below that threshold then we 
considered population went extinct for that simulation. We also calculated $2.5^{th}$ and $97.5^{th}$ quantiles
of $10000$ simulations with the probability of computed extinction risk at each time step.

To test our hypothesis from (Q1), we repeated the above analysis 
considering the vital rates coming from an asymmetric copula with specific 
left (Clayton, Survival Gumbel)
or right (Survival Clayton, Gumbel) tail dependence
or from an extreme tail-depentdent one, 
when vital rates were considered to be affected
by extreme climatic events. A $N \times 2$ matrix, M, was generated
using `BiCopSim` function from `VineCopula` package 
for each of the left (Clayton, Survival Gumbel) and right 
(Survival Clayton, Gumbel) tail-dependent bivariate copulas, 
where $N$ is number of years ($25$) multiplied by number of simulations ($10000$) we used. 
We kept the same Kendall's correlation ($\tau = 0.6$) for 
each bivariate copula from one parameter family which used its parameter accordingly
(see `iTau` function from `copula` package). Entries within each clumn of
matrix $M$, were thus 
independent of each others but 
the two columns of $M$ had a specified Kendall's 
correlation ($\tau = 0.6$) and underlying tail-dependence. 
Similarly, for extreme-tail dependent bivariant copula
(either left or right tail) a matrix M was generated from standard iid as described in 
Appendix \ref{SM-extr_tail_dep}. 

We made the first column of matrix 
$M$ as gamma ($\Gamma(k,\theta)$) distributed. 
$k = 2$ and $\theta = 1$ were shape and scale parameters, 
respectively. This column represented the distribution of fecundity of the adult population, $f_a$.
For a given $\theta$, increasing 
$k$ indicates distribution will shift towards higher fecundity which might 
reduce the extinction risk if the other parameters
remain unchanged. We took the second column of $M$ and applied a 
beta ($\mathcal{B}(\alpha,\beta)$) transformation. $\alpha =3$ and
$\beta = 2$ were the shape parameters which could control the distribution 
of the survival rates of eggs, $s_e$. 
For each $25$ timesteps from each of $10000$ simulations,
the vital rates (fecundity $f_a$ and survival rates $s_e$) 
of the stochastic projrction matrix in model (\ref{eq_age_str})
were drawn pairwise from each row of matrix $M$.
[`sim_age_str`](https://github.com/sghosh89/ERC/blob/master/ext_risk_cop_age_str.R) 
is the function we used to calculate extinction risk for age structured model.

<!--density-dependence metapopulation model-->
We explored (Q2) by examining how nature of the tail dependence of an
environmental variable across space could influence the extinction risk of a 
metapopulation model with density-dependence feedback. We considered six density-dependent 
population-growth models (Ricker, Hassell, Maynard Smith, Pennycuick, Verhulst, Austin-Brewer)
in noisy environment (see Table \ref{tab_model_summary}) 
from a metapopulation context.
Models were adapted from earlier work
by @cohen1995unexpected, excluding only two : Varley model (this is not a continuous one) 
and Malthus-Condorcet-Mill model (terms containing logarithm of extinct population does not make sense). 
All the models could be represented via 
a generalized form : $\vec{P}_{t+1} = D \lambda_t \vec{P_t}$,
where $\vec{P_t}$ was a vector of population densities, 
the $i^{th}$ component $P_t^i$ representing
the density in the $i^{th}$ habitat patch ($i=1,2,\ldots,n$) at time $t$. 
The $n \times n$ matrix $\lambda(t)$ was diagonal with $i^{th}$ diagonal entry 
of stochastic density dependence form $\lambda_i(t)$ (see second column 
of Table \ref{tab_model_summary}). For simplicity, 
we considered $n$ patches in each model were arranged, evenly spaced, in a line
with the provision of "local" or "global" dispersal among patches. A n $\times$ n dispersal
matrix, $D$ was constructed assuming that a fraction $d$ of 
each population patch dispersed during any given time step, equally distributed to
the two or one nearest neighbors in case of local dispersal. For global dispersal, the fraction
$d$ that dispersed
from each patch was divided up equally among all other patches. We called $d$ as dispersal
rate with $d$ being zero there was no dispersal, and threby no chance to rescue an extinct 
patch through migration from nearby metapopulation patches.

The environmental noises from any two out of $n$ patches, say, 
$(\epsilon_t^i, \epsilon_t^j)$ were normally 
distributed within each patch with mean $m=0$ and standard deviation $\sigma$ 
(see the specified value $\sigma$ for each model in 3$^{rd}$ 
column of Table \ref{tab_model_summary}). Noises were 
independent through time, and showed the same 
spatial correlations between patches (to within sampling error) for every simulation, 
but they were made to exhibit extreme right- or extreme left-tail dependence between patches in
different simulations. A three dimensional array, numsims $\times$ n $\times$ numsteps, 
$\epsilon$, was made from these extreme tail-dependence noise 
matrix generated via algorithm stated in 
Appendix \ref{SM-extr_tail_dep} and used to calculate extinction risk 
for each of the specified model in Table \ref{tab_model_summary} for $numsteps = 25$ years, $n =$ 5 patches
and $numsims = 10000$ simulations.  

The models stated in Table \ref{tab_model_summary} had one thing in 
common that they showed undercompensatory
dynamics (monotonic approach towards stable steady state $P_e$) when
growth parameter $r$ remained below a critical 
level, say, $r_c$. If $r$ was beyond $r_c$, model showed 
overcompensatory dynamics with oscillatory approach 
towards stable equilibrium $P_e$. But if $r$ became too high and went
beyond $r_{bf}$, the parameter value responsible for Hopf-bifurcation,
model equilibrium $P_e$ became unstable and model could show sustained
oscillation and eventually led to chaos. Appendix \ref{SM-model_stability}
summarizes the stability analysis of each model in their deterministic form.

<!--say how you set ext. threshold = Pe/10-->
We started with $n$ patches of initial population $P_{t=0}^i = P_e^i, (i = 1,2,\ldots,n)$ where 
$P_e^i$ was the equilibrium value (or similar to carrying capacity concept) 
for each density-dependence model (see 4$^{th}$ column of Table \ref{tab_model_summary}).
We assumed population went extinct after each time step if it was below a certain threshold.
That extinction threshold was set to 10\% of initial population $P_e$ for individual model. 

<!--test hypothesis from Q2 : ext risk with density-dependence metapopulation model with r from different regime-->
To test our hypothesis from (Q2) of \nameref{Introduction} for each metapopulation model,
we estimated extinction risk for a wide range of parameter $r$, 
which covered the undercompensatory and overcompensatory regime. We 
chose equispaced values of $r$ from the 95\% quantiles 
of possible range ($r_{min},r_{bf}$), where $r_{min}$ was the minimum value of $r$ 
for which the model equilibrium $P_e$ had always a finite, positive initial 
population (for details, see Appendix \ref{SM-model_stability}). For each chosen $r$ from each 
model where metapopulation could disperse locally with varying dispersal 
rate $d= 0,0.1,0.2,..0.5$, we calculated extinction risk with left 
tail dependent and right tail dependent environmental noise 
in different simulations, respectively. We also repeated the analysis 
for global dispersal for each metapopulation model. Script 
[`mydispersal.R`](https://github.com/sghosh89/ERC/blob/master/mydispersal.R) was used for this 
analysis.

<!--test hypothesis from Q3 : switching of ext risk with density-dependence metapopulation model with d=0-->
Given hypothesis from (Q2) was valid which scrutinized that whereas 
left tail dependence in noise made extinction risk 
higher in undercompensatory regime ($r < r_c$), it was the 
right tail dependent noise
which appeared to evoke higher extinction risk for metapopulations
in overcompensatory regime ($r > r_c$), we tested our third hypothesis for (Q3).
We considered
the switching to take place near $r_c$, not exactly at $r = r_c$ because the transition point $r_c$
from under to overcompensatory dynamics was expected to differ in stochastic environment than its 
deterministic analog depending on the underlying nonlinearity of the model.
We generated plots with extinction risk along y-axis
for both left tail and right tail dependent noises 
against the varying range of $r$ (along x-axis) when no dispersal ($d=0$) was considered.
We excluded the possibility of dispersal in this case to avoid any rescue effect among patches. 
For each model with extreme left and extreme right tail dependent noises, we calculated 
2.5$^{th}$ and 97.5$^{th}$ quantiles
of 10000 simulations with the probability of computed
extinction risk at each $r$. We compared $r_c$ and the value of $r$ at which 
95\% CI of extinction risk from both noises overlapped
with each other. This could give us an idea for supporting our hypothesis.

# Results\label{Results}

<!--Q1 : age structured results : linear and nonlinear model with asymmetric copula : Fig. S1-->
<!--Q1 : age structured results : linear and nonlinear model with extreme tail dep. copula : Fig. 1 -->

For single patch linear age-structured models, we found left-tail 
dependence (Clayton, Suvival Gumbel copulas) in noisy vital 
rates enhanced the extinction risk compared to the case when
vital rates were right tail dependent (Survival clayton, Gumbel copulas).
It was expected because a sudden "bad" year (e.g. with severe cold) can suppress 
the fecundity of adult and survival/ maturation of eggs simultaneously 
and thereby increasing the extinction risk of the population. For non-linear age-structured 
models, we got the similar trend for extinction risks with different tail-dependence (left and right).
With non-linear model the extinction risks appeared as higher than their corresponding 
linear analog as it was evident from Eq. \ref{eq_vitalrates} with finite $\Omega = 100$. 
Fig. \ref{SM-fig_extrisk_agestr_mtd} represents this scenario with 4 different 
asymmetric copulas but of same Kendall's correlation ($\tau = 0.6$). There was very little
difference between extinction risks within a pair of different tail-dependent copulas
(e.g. C-SC in Fig. \ref{SM-fig_extrisk_agestr_mtd}(A,C) and
G-SG in Fig. \ref{SM-fig_extrisk_agestr_mtd}(B,D)) and that difference was partly 
dependent on the strength of tail dependence. Therefore we repeated the same analysis with 
vital rates coming from extreme-tail dependent (left and right in two different simulations)
copulas and got the similar results but with much prominent difference between their extinction risks
(Fig. \ref{fig_extrisk_agestr_etd}). This result answered (Q1) and showed extinction risk of 
a population could be considered as
direct manifestation of tail-dependence measure between vital rates of different age-class
within that population. <!--discussion later : add Tuljapurkar's approximation-->

<!--Q2 : metapopulation results : density dependence with extreme tail dep. copula-->
<!--For local dispersal : all model summary : Fig. 2, individual model : Fig. S3-S8-->
<!--For global dispersal : all model summary : Fig. S2, individual model : Fig. S9-S14-->

We found density-dependence metapopulation models (with $n=5$ patches) in noisy 
environment showed similar patterns for extinction risk as density-independent 
metapopulation model showed in earlier studies [@Ghosh_copula]. For each density-dependent 
model listed in Table \ref{tab_model_summary}, we observed higher (or lower) extinction risk for 
the metapopulations when noises across multiple patches were left- (or right) tail dependent.
But that observation remained valid when the model parameter, usually growth rate $(r)$, of each model was 
sufficiently low so that under-compensatory dynamics (monotonous approach towards
its stable equilibrium) for the deterministic analog of the model was ensured. When the model 
was in over-compensatory regime (oscillatory approach towards stable equilibrium) for higher 
value of $r$, we observed right (or left) tail dependent noise caused higher (or lower) extinction 
risk for the metapopulations. Fig. \ref{fig_extrisk_allmodel_localdisp} shows variation of extinction risk 
against local dispersal rate ($d$) for six density dependent metapopulation models 
where growth rate $r$ was taken either from under-compensatory or from over-compensatory 
regime. We also got similarly consisent results with 
our prediction (see Q2 from \nameref{Introduction}) for global 
dispersal (Fig. \ref{SM-fig_extrisk_allmodel_globaldisp}). 
Figs. (\ref{SM-fig_ricker_risk_local_disp_scl_1} - \ref{SM-fig_risk_local_disp_abrewer_r_vary_scl_0.6}) 
shows how extinction risk changed against local dispersal rate for a whole range
of $r$, whereas Figs. (\ref{SM-fig_ricker_risk_global_disp_scl_1} - 
\ref{SM-fig_risk_global_disp_abrewer_r_vary_scl_0.6}) 
represents the same but for the case when global dispersal took place between patches. 
Both case showed the signature of 
"rescue-effect" (i.e. by lowering extinction risk) when there was 
a finite dispersal compared to the one with 
$d=0$.

<!--Q3 : metapopulation results : switching near rc for d=0, Fig. 3-->
Following Figs. (\ref{SM-fig_ricker_risk_local_disp_scl_1} - 
\ref{SM-fig_risk_global_disp_abrewer_r_vary_scl_0.6}) we hypothesized that the switching 
between the extinction risk generated by left-tail dependent and right-tail dependent noise 
occurred near the critical parameter $r_c$ (see Q3). For simplicity we only consider 
$d=0$ case, i.e., when there was no dispersal between patches (see \nameref{Methods}). 
Fig. \ref{fig_extrisk_d0} shows higher extinction risk with left-tail dependent noise 
for $r<r_c$ and with right-tail dependent noise for $r>r_c$. $r_c$ was the vertical
line in Fig. \ref{fig_extrisk_d0} indicating the value of $r$ for each model where 
their deterministic analog switches from under- to over-compensatory dynamics. 
Though the switching visually appered far from the theoretical $r_c$ value for Verhulst 
and Austin-Brewer model, they were consistent with our hypothesis as they had comperatively 
smaller range of $r$ than the other models.


# Discussion

<!--summary results:-->
Our results show the potential use of "asymmetric" copula in estimating the impact of 
extreme ecological events on population-extinction risk. We show that through left and right tail 
dependence in vital rates (respectively, spatially correlated environmental noises), years of extreme events 
("catastrophs" and "bonanzas") affect extinction risk of a single-patch age-structured population
(respectively, density dependent metapopulations) differently. Though left tail dependence is 
expected to show higher extinction risk than the one for right tail dependence for age-structured 
and density dependent metapopulation models, it is not always true 
when metapopulation models with dispersal show over-compensatory dynamics. In the over-compensatory regime,
right tail dependent noises result in higher extinction risk than the left tail dependent one. We show 
that in absence of dispersal, the above-said switching in extinction risk measure occurs near the 
critical parameter value where the deterministic model shows transition from 
under-compensatory to over-compensatory regime.

<!--Tuljapurkar approximation : linear version of age-structured model in stochastic environments-->
We found left tail dependence in vital rates (induced by ECEs) caused higher extinction risk than 
the right tail dependent ones, but the difference was not remarkable (Fig. \ref{SM-fig_extrisk_agestr_mtd}) 
unless the tail dependence was at its extreme (Fig. \ref{fig_extrisk_agestr_etd}). This finding could be explained 
by the approximation @tuljapurkar1990lecture made for the stochastic log(growth rate) in an iid environment.
The approximation considered that the growth rate depends on the most dominant eigen value of the mean projection matrix 
and the temporal variance of the log(population growth rate) caused by environmental stochasticity, which was based
on the linear covariance measure between any two matrix elements, not on their tail-dependence properties. Therefore,
according to Tuljapurkar's approximation, population growth rate in an iid environment 
remained same for our model (Eq. \ref{eq_age_str}) with left-tail or right-tail dependent noises.

<!--future study: worthy for PVA, IUCN red list
1. Identify which life stage or demographic process as management target?
2. Old study (Doak1994, Ferguson1995) showed including correlation btw vital rates for PVA makes a difference, 
   what if we include TD through copula? Multisite age str. model with dispersal, directional change
   in spatio-temporal variation for vital rates.
3. Tdep. with -ve correlation between vital rates?
4. extinction risk how propagated through a food web?
-->
Although we demonstrated that tail dependence between vital rates of an age structured model can
influence extinction risk, substantial work remains to determine the importance of this effect in the 
following scenarios. First, we demonstrated the effect of tail-dependence on extinction risk 
with a very simplistic age structured (two age stages) model where we considered the total semelperous 
population would go extinct if there would be only one female adult and one egg. But in reality population 
viability analysis (PVA) deals with a little bit higher threshold with several age, stage or size class and a variety 
of populations including semelperous and iteroperous [@morris2002quantitative]. Future studies should include 
tail-dependence effect on extinction risk 
for a multiple age-, size- and stage- structured model and estimate extinction risk 
for each age, size and stage class separately 
so that we can identify (via multisite-PVA) which life-stage or demographic process 
to target for population management. Earlier study by @doak1994modeling showed PVA models including correlation 
between different demographic rates indicated marked difference in predicting confidence interval for 
future population size than the model which did not include correlation. But when 
such correlation cannot be estimated directly, more generally where the
forms of statistical dependence among the model's parameters are unknown, making incorrect
assumptions about correlations and dependencies may lead to severe over-estimation 
or under-estimation of extinction risks [@ferson1995correlations]. We believe modeling 
dependencies with copula could help in this case. Second, we did not consider multiple sites of 
age-structured metapopulation which could be linked via dispersal. So, possible future investigation 
would be to explore the viability for the metapopulations if vital rates (e.g. fecundity or 
survival of different stage class) across sites showed specific tail dependence 
with spatially correlated extreme climatic events. Third, we considered tail dependence 
between vital rates when they were positively correlated, but what would be the extinction risk 
and viability of a population if demographic rates were negatively correlated with asymmetric tail dependence. 
This scenario could be considered for those extreme events that kill adults and allow more successful
recruitment of seeds or other propagules. Fourth, following the aforementioned idea, it would be worthy 
to model more complex prey-predator model where asymmetric tail dependent copula could be used to mimic
interspecific-dependence. An earlier study [@carnicer2011widespread] showed extreme events
(i.e., heat waves and droughts) increased mortality and defoliation in southern European forest and its 
dependent herbivorous insects and fungi through trophic linkage. ECEs can even truncate 
multiyear insect outbreak dynamics [@esper20061200]. We believe copula (may be a multidimensional one) has 
a lot more potential to estimate risk of cascading extinction in model food webs. 

<!--match-mismatch hypothesis leads to extinction? our phenology paper in prep.-->







 
 <!--FIG : age structure model results : linear, nonlinear-->
\begin{figure*}[!h]
\textbf{ \hspace{5.4 cm} (A) \hspace{4 cm} (B)} \\
\vspace{-0.9 cm}
\begin{center}
\includegraphics[width=5 cm]{./Results/age_str_results/extrisk_age_str_extremetail_linear.pdf}
\includegraphics[width=5 cm]{./Results/age_str_results/extrisk_age_str_extremetail_nonlinear_omg_100.pdf}\\
\caption{Extinction risk from single patch age structured $(A)$ linear ($\Omega = \infty$) and $(B)$ nonlinear ($\Omega = 100$) models against time (shading represents 95\% confidence interval). Fecundity of adults and survival of eggs have either extreme left or extreme right tail dependence, numsims=10000. \label{fig_extrisk_agestr_etd}}
\end{center}
\end{figure*}

<!--FIG :  summary : all nonlinear model results for local dispersion : extrisk vs. d-->
\begin{figure*}[!h]
\begin{center}
\includegraphics[width=15 cm]{./Results/allmodel_ext_risk_local_disp_extremenoise.pdf}
\caption{For each of six nonlinear density-dependence models presented in Table \ref{tab_model_summary} with local dispersal
among $n=5$ patches, extinction risk after $numsteps = 25$ years for $numsims = 10000$ simulations were calculated.
Extinction risk varies as dispersion-rate ($d$) goes from $0$ to $0.5$. Last two columns represent extinction risk calculated for intrinsic growth rate $(r)$ taken from under-compensatory and over-compensatory regime of deterministic model analog, respectively.\label{fig_extrisk_allmodel_localdisp}}
\end{center}
\end{figure*}


 <!--FIG : all nonlinear model results with d=0, extrisk vs. r-->
\begin{figure*}[!h]
\begin{center}
\includegraphics[width=10 cm]{./Results/common_legend.pdf}\\
\includegraphics[width=5 cm]{./Results/ricker_scl_1/ricker_extrisk_d0_extremenoise.pdf}
\includegraphics[width=5 cm]{./Results/hassell_scl_1/hassell_extrisk_d0_extremenoise.pdf}\\
\vspace{-0.6 cm}
\includegraphics[width=5 cm]{./Results/msmith_scl_0.8/msmith_extrisk_d0_extremenoise.pdf}
\includegraphics[width=5 cm]{./Results/pennycuick_scl_1/pennycuick_extrisk_d0_extremenoise.pdf}\\
\vspace{-0.6 cm}
\includegraphics[width=5 cm]{./Results/verhulst_scl_0.6/verhulst_extrisk_d0_extremenoise.pdf}
\includegraphics[width=5 cm]{./Results/austinbrewer_scl_0.6/abrewer_extrisk_d0_extremenoise.pdf}\\
\caption{Transition of higher to lower extinction risk (calculated after $25$ years) for 
the metapopulations affected by extreme left tail dependent noise across
$5$ multiple patches without dispersal ($d=0$), as intrinsic 
growth rate ($r$) goes from under to over-compensatory regime. Opposite trend
was observed with extreme right tail dependent noise.
Error bars represent the standard errors associated with $10000$
simulations for extinction risk computed at each $r$. Dotted line represents the value of $r$
for each model where their deterministic analog switches from under- to over-compensatory dynamics.
\label{fig_extrisk_d0}}
\end{center}
\end{figure*}

<!--Summary tables for 6 nonlinear models used-->
```{r read_tab_model_summary,echo=F, results='asis',message=F}
library(kableExtra)
library(dplyr)
dt<-readRDS("./Results/tab_model_summary.RDS")
knitr::kable(dt, escape=F,
             format="latex",digits=3, align="c",table.env='table*',
             caption = "Summary of six density dependence metapopulation models considered for each patch; last three columns indicated equilibrium population value ($P_e^{i}$), critical growth rate ($r_c^{i}$ : transition point from under- to over-compensatory dynamics of deterministic models) and bifurcation parameter ($r_{bf}^{i}$ : transition point from stable to unstable equilibrium of deterministic models), respectively. Superscript $i=1,2,...,n$ indicates states for $i^{th}$ patch.\\label{tab_model_summary}",
             booktabs=T, linesep = "\\addlinespace"
             )%>%column_spec(c(1,3,5,6),width="1.4 cm")%>%kable_styling(latex_options = "basic",position = "center")%>%column_spec(2, width = "3.8 cm")
```


\clearpage

# Literature cited

\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{1pt}
\noindent



